<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="multiverse">
<title>Exporting the output of a multiverse to JSON for Milliways, a multiverse visualisation tool • multiverse</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/Nunito_Sans-0.4.9/font.css" rel="stylesheet">
<link href="../deps/Georgia-0.4.9/font.css" rel="stylesheet">
<!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.11/clipboard.min.js" integrity="sha512-7O5pXpc0oCRrxk8RUfDYFgn0nO1t+jLuIOQdOMRp4APB7uZ4vSjspzp5y6YDtDs4VzUSTbWzBFZ/LKJhnyFOKw==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet">
<meta property="og:title" content="Exporting the output of a multiverse to JSON for Milliways, a multiverse visualisation tool">
<meta property="og:description" content="multiverse">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light" data-bs-theme="light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">multiverse</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.6.2.2</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/branch.html">A discussion on branches in the multiverse</a>
    <a class="dropdown-item" href="../articles/conditions.html">Declaring conditions in the multiverse</a>
    <a class="dropdown-item" href="../articles/example-dance.html">Example multiverse implementation: Recreating Adding inferential treatments to plots using Resampling and Animations using multiverse</a>
    <a class="dropdown-item" href="../articles/example-durante.html">Example multiverse implementation: Effect of fertility on religiosity and political attitudes</a>
    <a class="dropdown-item" href="../articles/example-frequentist.html">Example multiverse implementation: Re-evaluating the efficiency of physical visualizations</a>
    <a class="dropdown-item" href="../articles/example-hurricane.html">Example multiverse implementation: Female hurricanes are deadlier than male hurricanes</a>
    <a class="dropdown-item" href="../articles/execution-multiverse.html">Execution of multiverse analysis: Sequential and Parallel</a>
    <a class="dropdown-item" href="../articles/export-milliways.html">Exporting the output of a multiverse to JSON for Milliways, a multiverse visualisation tool</a>
    <a class="dropdown-item" href="../articles/multiverse-in-rmd.html">Using the multiverse in RMarkdown: Introduction to multiverse code chunks</a>
    <a class="dropdown-item" href="../articles/visualising-multiverse.html">Extracting and Visualising the results of a multiverse analysis</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/MUCollective/multiverse/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Exporting the output of a multiverse to JSON for Milliways, a multiverse visualisation tool</h1>
                        <h4 data-toc-skip class="author">Abhraneel
Sarma</h4>
            
            <h4 data-toc-skip class="date">2024-08-03</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/MUCollective/multiverse/blob/HEAD/vignettes/export-milliways.Rmd" class="external-link"><code>vignettes/export-milliways.Rmd</code></a></small>
      <div class="d-none name"><code>export-milliways.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>The correct interpretation of a multiverse analysis can be difficult
due to their potential size and the complexity of correctly interpreting
their uncertainty. Our recent work in developing <a href="https://abhsarma.github.io/milliways/" class="external-link">Milliways</a>, an
interactive visualisation interface for the principled evaluation and
interpretation of the results of multiverse analysis aims to address
this problem. For more details, please refer to our <a href="https://mucollective.northwestern.edu/files/2024-milliways.pdf" class="external-link">paper</a>.</p>
</div>
<div class="section level2">
<h2 id="milliways">Milliways<a class="anchor" aria-label="anchor" href="#milliways"></a>
</h2>
<p>To visualise the results of a multiverse analysis using Milliways,
the user needs to provide four files:</p>
<ul>
<li>
<code>results</code>: a JSON file which contains the estimates from
each universe in the multiverse analysis.</li>
<li>
<code>code</code>: a JSON file which contains the code used to
generate the multiverse object.</li>
<li>
<code>data</code>: a JSON file which contains the dataset used in
the multiverse analysis.</li>
<li>
<code>analysis</code>: an HTML file which contains the entire
analysis as an Explorable Multiverse Analysis Report (EMAR).</li>
</ul>
<p>In this document, I outline how to generate each of these files for
the multiverse analysis on the Durante dataset (see
<code><a href="../articles/visualising-multiverse.html">vignette("visualising-multiverse")</a></code>). Compiling this
document will, by itself, result in the creation of the EMAR,
provided:</p>
<ul>
<li>the <code><a href="../reference/knit_as_emar.html">knit_as_emar()</a></code> function is declared, and</li>
<li>the document YAML (at the top of the markdown file) is set to
<code>output: html_document</code>
</li>
</ul>
<p>The actual EMAR document which is generated from this file (provided
the YAML is changed) can be found <a href="https://abhsarma.github.io/assets/milliways/durante-EMAR.html" class="external-link">here</a>.</p>
<p><strong>Note #1:</strong> Creating an EMAR document is not a perfect
process unfortunately, and relies on the HTML tags that
<code>knitr</code> uses to convert a RMarkdown file to an HTML file. We
created the <code><a href="../reference/knit_as_emar.html">knit_as_emar()</a></code> function assuming users will
compile using the default YAML (<code>output: html_document</code>) that
is generated when a new RMarkdown file is created using RStudio.
However, the <code><a href="../reference/knit_as_emar.html">knit_as_emar()</a></code> function may not be compatible
with other output formats, such as this one which uses the
<code>html_vignette</code> format. I have also marked the multiverse
code chunks using a comment to distinguish them from regular R code
chunks. However, if you are knitting as an EMAR, the multiverse code
chunks will appear with a different background colour to the regular
code chunks making them easily distinguishable.</p>
<p><strong>Note #2:</strong> If compiling the document as an EMAR, each
code chunk will execute automatically. You do not need to call
<code><a href="../reference/execute.html">execute_multiverse()</a></code> to obtain the results unless you want
to extract the results and access it from an R code chunk.</p>
<p><strong>Note #3:</strong> If you are not compiling the document as an
EMAR, the code chunks will not execute automatically. The only way to
obtain the results is to first execute all the universes in the
multiverse using <code><a href="../reference/execute.html">execute_multiverse()</a></code> and then accessing
the results using an R code chunk.</p>
<p><strong>Note #4:</strong> On the use of magrittr pipes
(<code>%&gt;%</code>) instead of the native R pipe (<code>|&gt;</code>).
Because <code>multiverse</code> rewrites R expressions, when I parse the
code declared into individual R scripts, the native R pipe is
“evaluated” (i.e. <code>df |&gt; mutate(...) |&gt; filter(...)</code>
becomes <code>filter(mutate(df, ...), ...)</code>); this makes the code
readable. Instead I use magrittr pipes which does not “evaluate” the R
expressions.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/knit_as_emar.html">knit_as_emar</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="analysis">Analysis<a class="anchor" aria-label="anchor" href="#analysis"></a>
</h2>
<p>The analysis follows the same steps outlined in
<code><a href="../articles/example-durante.html">vignette("example-durante")</a></code>. The first step is to read the
raw data from the file and store it as a tibble.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"durante"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">data.raw.study2</span> <span class="op">&lt;-</span> <span class="va">durante</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>    Abortion <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="fl">7</span> <span class="op">-</span> <span class="va">Abortion</span><span class="op">)</span> <span class="op">+</span> <span class="fl">1</span>,</span>
<span>    StemCell <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="fl">7</span> <span class="op">-</span> <span class="va">StemCell</span><span class="op">)</span> <span class="op">+</span> <span class="fl">1</span>,</span>
<span>    Marijuana <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="fl">7</span> <span class="op">-</span> <span class="va">Marijuana</span><span class="op">)</span> <span class="op">+</span> <span class="fl">1</span>,</span>
<span>    RichTax <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="fl">7</span> <span class="op">-</span> <span class="va">RichTax</span><span class="op">)</span> <span class="op">+</span> <span class="fl">1</span>,</span>
<span>    StLiving <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="fl">7</span> <span class="op">-</span> <span class="va">StLiving</span><span class="op">)</span> <span class="op">+</span> <span class="fl">1</span>,</span>
<span>    Profit <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="fl">7</span> <span class="op">-</span> <span class="va">Profit</span><span class="op">)</span> <span class="op">+</span> <span class="fl">1</span>,</span>
<span>    FiscConsComp <span class="op">=</span> <span class="va">FreeMarket</span> <span class="op">+</span> <span class="va">PrivSocialSec</span> <span class="op">+</span> <span class="va">RichTax</span> <span class="op">+</span> <span class="va">StLiving</span> <span class="op">+</span> <span class="va">Profit</span>,</span>
<span>    SocConsComp <span class="op">=</span> <span class="va">Marriage</span> <span class="op">+</span> <span class="va">RestrictAbortion</span> <span class="op">+</span> <span class="va">Abortion</span> <span class="op">+</span> <span class="va">StemCell</span> <span class="op">+</span> <span class="va">Marijuana</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="va">M</span> <span class="op">=</span> <span class="fu"><a href="../reference/multiverse.html">multiverse</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<div class="section level3">
<h3 id="cycle-length">Cycle Length<a class="anchor" aria-label="anchor" href="#cycle-length"></a>
</h3>
<p>In their Durante et al. exclude participants based on the length of
their menstrual cycle, and only include those whose cycle lengths are
between 25 and 35 days. However, according to Steegen et al., due to the
flexibility in the data collection, “this exclusion criterion can be
instantiated in two reasonable ways, using either a woman’s computed
cycle length or a woman’s self-reported typical cycle length.”</p>
<p><strong>Note #5:</strong> we can define a tangle widget to allow the
user to switch between which operationalisation of the outlier exclusion
criteria is used using the syntax
<code>&lt;mv param="cycle_length"/&gt;</code>. Here,
<code>cycle_length</code> can be replaced with the name of any
parameter. In the EMAR document, you can see and interact with the
tangle widget. We have removed them in this document as they do not get
rendered properly when compiling to a vignette.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># multiverse code block</span></span>
<span><span class="va">df</span> <span class="op">&lt;-</span> <span class="va">data.raw.study2</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>ComputedCycleLength <span class="op">=</span> <span class="va">StartDateofLastPeriod</span> <span class="op">-</span> <span class="va">StartDateofPeriodBeforeLast</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="fu"><a href="../reference/branch.html">branch</a></span><span class="op">(</span></span>
<span>    <span class="va">cycle_length</span>,</span>
<span>    <span class="st">"cl_option1"</span> <span class="op">~</span> <span class="cn">TRUE</span>,</span>
<span>    <span class="st">"cl_option2"</span> <span class="op">~</span> <span class="va">ComputedCycleLength</span> <span class="op">&gt;</span> <span class="fl">25</span> <span class="op">&amp;</span> <span class="va">ComputedCycleLength</span> <span class="op">&lt;</span> <span class="fl">35</span>,</span>
<span>    <span class="st">"cl_option3"</span> <span class="op">~</span> <span class="va">ReportedCycleLength</span> <span class="op">&gt;</span> <span class="fl">25</span> <span class="op">&amp;</span> <span class="va">ReportedCycleLength</span> <span class="op">&lt;</span> <span class="fl">35</span></span>
<span>  <span class="op">)</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="certainty">Certainty<a class="anchor" aria-label="anchor" href="#certainty"></a>
</h3>
<p>Steegen et al. describe that how certain the participants are in
their reported dates can be another justifiable exclusion criteria:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># multiverse code block</span></span>
<span><span class="va">df</span> <span class="op">&lt;-</span> <span class="va">df</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="fu"><a href="../reference/branch.html">branch</a></span><span class="op">(</span></span>
<span>    <span class="va">certainty</span>,</span>
<span>    <span class="st">"cer_option1"</span> <span class="op">~</span> <span class="cn">TRUE</span>,</span>
<span>    <span class="st">"cer_option2"</span> <span class="op">~</span> <span class="va">Sure1</span> <span class="op">&gt;</span> <span class="fl">6</span> <span class="op">|</span> <span class="va">Sure2</span> <span class="op">&gt;</span> <span class="fl">6</span></span>
<span>  <span class="op">)</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="menstrual-calculation">Menstrual Calculation<a class="anchor" aria-label="anchor" href="#menstrual-calculation"></a>
</h3>
<p>The flexibility in how the data is collected also allows three
reasonable alternatives for estimating a woman’s next menstrual onset,
which is an intermediate step in determining cycle day.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># multiverse code block</span></span>
<span><span class="va">df</span> <span class="op">&lt;-</span> <span class="va">df</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>NextMenstrualOnset <span class="op">=</span> <span class="fu"><a href="../reference/branch.html">branch</a></span><span class="op">(</span></span>
<span>    <span class="va">menstrual_calculation</span>,</span>
<span>    <span class="st">"mc_option1"</span> <span class="op">~</span> <span class="va">StartDateofLastPeriod</span> <span class="op">+</span> <span class="va">ComputedCycleLength</span>,</span>
<span>    <span class="st">"mc_option2"</span> <span class="op"><a href="../reference/conditionals.html">%when%</a></span> <span class="op">(</span><span class="va">cycle_length</span> <span class="op">!=</span> <span class="st">"cl_option2"</span><span class="op">)</span> <span class="op">~</span> <span class="va">StartDateofLastPeriod</span> <span class="op">+</span> <span class="va">ReportedCycleLength</span>,</span>
<span>    <span class="st">"mc_option3"</span> <span class="op">~</span> <span class="va">StartDateNext</span></span>
<span>  <span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>    CycleDay <span class="op">=</span> <span class="fl">28</span> <span class="op">-</span> <span class="op">(</span><span class="va">NextMenstrualOnset</span> <span class="op">-</span> <span class="va">DateTesting</span><span class="op">)</span>,</span>
<span>    CycleDay <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">WorkerID</span> <span class="op">==</span> <span class="fl">15</span>, <span class="fl">11</span>, <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">WorkerID</span> <span class="op">==</span> <span class="fl">16</span>, <span class="fl">18</span>, <span class="va">CycleDay</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    CycleDay <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">CycleDay</span> <span class="op">&gt;</span> <span class="fl">1</span> <span class="op">&amp;</span> <span class="va">CycleDay</span> <span class="op">&lt;</span> <span class="fl">28</span>, <span class="va">CycleDay</span>, <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">CycleDay</span> <span class="op">&lt;</span> <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">28</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="fertility">Fertility<a class="anchor" aria-label="anchor" href="#fertility"></a>
</h3>
<p>Durante et al. classify women into a high or low fertility group
based on cycle day, but this classification can be done in various
different reasonable ways:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># multiverse code block</span></span>
<span><span class="va">df</span> <span class="op">&lt;-</span> <span class="va">df</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>Fertility <span class="op">=</span> <span class="fu"><a href="../reference/branch.html">branch</a></span><span class="op">(</span></span>
<span>    <span class="va">fertile</span>,</span>
<span>    <span class="st">"fer_option1"</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">CycleDay</span> <span class="op">&gt;=</span> <span class="fl">7</span> <span class="op">&amp;</span> <span class="va">CycleDay</span> <span class="op">&lt;=</span> <span class="fl">14</span>, <span class="st">"high"</span>, <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">CycleDay</span> <span class="op">&gt;=</span> <span class="fl">17</span> <span class="op">&amp;</span> <span class="va">CycleDay</span> <span class="op">&lt;=</span> <span class="fl">25</span>, <span class="st">"low"</span>, <span class="cn">NA</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    <span class="st">"fer_option2"</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">CycleDay</span> <span class="op">&gt;=</span> <span class="fl">6</span> <span class="op">&amp;</span> <span class="va">CycleDay</span> <span class="op">&lt;=</span> <span class="fl">14</span>, <span class="st">"high"</span>, <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">CycleDay</span> <span class="op">&gt;=</span> <span class="fl">17</span> <span class="op">&amp;</span> <span class="va">CycleDay</span> <span class="op">&lt;=</span> <span class="fl">27</span>, <span class="st">"low"</span>, <span class="cn">NA</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    <span class="st">"fer_option3"</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">CycleDay</span> <span class="op">&gt;=</span> <span class="fl">9</span> <span class="op">&amp;</span> <span class="va">CycleDay</span> <span class="op">&lt;=</span> <span class="fl">17</span>, <span class="st">"high"</span>, <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">CycleDay</span> <span class="op">&gt;=</span> <span class="fl">18</span> <span class="op">&amp;</span> <span class="va">CycleDay</span> <span class="op">&lt;=</span> <span class="fl">25</span>, <span class="st">"low"</span>, <span class="cn">NA</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    <span class="st">"fer_option4"</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">CycleDay</span> <span class="op">&gt;=</span> <span class="fl">8</span> <span class="op">&amp;</span> <span class="va">CycleDay</span> <span class="op">&lt;=</span> <span class="fl">14</span>, <span class="st">"high"</span>, <span class="st">"low"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    <span class="st">"fer_option5"</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">CycleDay</span> <span class="op">&gt;=</span> <span class="fl">8</span> <span class="op">&amp;</span> <span class="va">CycleDay</span> <span class="op">&lt;=</span> <span class="fl">17</span>, <span class="st">"high"</span>, <span class="st">"low"</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">)</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="relationship-status">Relationship Status<a class="anchor" aria-label="anchor" href="#relationship-status"></a>
</h3>
<p>The participants in the study described their relationship status as
one of the following options: (1) not dating/romantically involved with
anyone, (2) dating or involved with only one partner, (3) engaged or
living with my partner, and (4) married. This allows various different
ways of classifying whether a participants is in a relationship or
not:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># multiverse code block</span></span>
<span><span class="va">df</span> <span class="op">&lt;-</span> <span class="va">df</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>RelationshipStatus <span class="op">=</span> <span class="fu"><a href="../reference/branch.html">branch</a></span><span class="op">(</span></span>
<span>    <span class="va">relationship_status</span>,</span>
<span>    <span class="st">"rs_option1"</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">Relationship</span> <span class="op">==</span> <span class="fl">1</span> <span class="op">|</span> <span class="va">Relationship</span> <span class="op">==</span> <span class="fl">2</span>, <span class="st">"Single"</span>, <span class="st">"Relationship"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    <span class="st">"rs_option2"</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">Relationship</span> <span class="op">==</span> <span class="fl">1</span>, <span class="st">"Single"</span>, <span class="st">"Relationship"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    <span class="st">"rs_option3"</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">Relationship</span> <span class="op">==</span> <span class="fl">1</span>, <span class="st">"Single"</span>, <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">Relationship</span> <span class="op">==</span> <span class="fl">3</span> <span class="op">|</span> <span class="va">Relationship</span> <span class="op">==</span> <span class="fl">4</span>, <span class="st">"Relationship"</span>, <span class="cn">NA</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>RelComp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="op">(</span><span class="va">Rel1</span> <span class="op">+</span> <span class="va">Rel2</span> <span class="op">+</span> <span class="va">Rel3</span><span class="op">)</span> <span class="op">/</span> <span class="fl">3</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="regression-model">Regression Model<a class="anchor" aria-label="anchor" href="#regression-model"></a>
</h2>
<p>The authors perform an ANOVA to study the effect of
<em>Fertility</em>, <em>Relationship</em> and their interaction term, on
the composite Religiosity score. We fit the linear model using the call:
<code>lm( RelComp ~ Fertility * RelationshipStatus, data = df )</code>
inside our multiverse and save the result to a variable called
<code>fit_RelComp</code>. We use <code><a href="https://generics.r-lib.org/reference/tidy.html" class="external-link">broom::tidy</a></code> to extract the
results of the linear model into a tidy data frame.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fit_RelComp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">RelComp</span> <span class="op">~</span> <span class="va">Fertility</span> <span class="op">*</span> <span class="va">RelationshipStatus</span>, data <span class="op">=</span> <span class="va">df</span><span class="op">)</span></span>
<span><span class="va">summary_RelComp</span> <span class="op">&lt;-</span> <span class="va">fit_RelComp</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu">broom</span><span class="fu">::</span><span class="fu"><a href="https://generics.r-lib.org/reference/tidy.html" class="external-link">tidy</a></span><span class="op">(</span>conf.int <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="va">summary_RelComp</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 4 × 7</span></span></span>
<span><span class="co">##   term                  estimate std.error statistic  p.value conf.low conf.high</span></span>
<span><span class="co">##   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span> (Intercept)               6.37     0.405     15.8  4.02<span style="color: #949494;">e</span><span style="color: #BB0000;">-41</span>    5.58      7.17 </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">2</span> Fertilitylow             -<span style="color: #BB0000;">1.16</span>     0.534     -<span style="color: #BB0000;">2.18</span> 3.02<span style="color: #949494;">e</span><span style="color: #BB0000;">- 2</span>   -<span style="color: #BB0000;">2.21</span>     -<span style="color: #BB0000;">0.112</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">3</span> RelationshipStatusSi…    -<span style="color: #BB0000;">1.51</span>     0.538     -<span style="color: #BB0000;">2.80</span> 5.38<span style="color: #949494;">e</span><span style="color: #BB0000;">- 3</span>   -<span style="color: #BB0000;">2.57</span>     -<span style="color: #BB0000;">0.450</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">4</span> Fertilitylow:Relatio…     2.05     0.714      2.87 4.46<span style="color: #949494;">e</span><span style="color: #BB0000;">- 3</span>    0.640     3.45</span></span></code></pre>
</div>
<div class="section level2">
<h2 id="visualising-the-results">Visualising the Results<a class="anchor" aria-label="anchor" href="#visualising-the-results"></a>
</h2>
<p>We visualise the results by showing the predicted values of the
model. The plot below shows the predicted <code>Religiosity Score</code>
for each level of <code>Fertility</code> (high or low) and
<code>RelationshipStatus</code> (Single or Relationship):</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">p_val</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">fit_RelComp</span><span class="op">)</span><span class="op">$</span><span class="va">coefficients</span><span class="op">[</span><span class="fl">4</span>, <span class="fl">4</span><span class="op">]</span>, <span class="fl">3</span><span class="op">)</span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="va">p_val</span> <span class="op">&lt;</span> <span class="fl">0.05</span><span class="op">)</span> <span class="va">p_val</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">p_val</span>, <span class="st">"*"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">broom</span><span class="fu">::</span><span class="fu"><a href="https://generics.r-lib.org/reference/augment.html" class="external-link">augment</a></span><span class="op">(</span><span class="va">fit_RelComp</span>, interval <span class="op">=</span> <span class="st">"confidence"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">Fertility</span>, <span class="va">RelationshipStatus</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>RelationshipStatus <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">RelationshipStatus</span> <span class="op">==</span> <span class="st">"Relationship"</span>, <span class="st">"InRelationship"</span>, <span class="st">"Single"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarise</a></span><span class="op">(</span>.fitted <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">.fitted</span><span class="op">)</span>, .upper <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">.upper</span><span class="op">)</span>, .lower <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">.lower</span><span class="op">)</span>, .groups <span class="op">=</span> <span class="st">"drop"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">RelationshipStatus</span>, y <span class="op">=</span> <span class="va">.fitted</span>, fill <span class="op">=</span> <span class="va">Fertility</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html" class="external-link">geom_bar</a></span><span class="op">(</span>stat <span class="op">=</span> <span class="st">"identity"</span>, position <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/position_dodge.html" class="external-link">position_dodge2</a></span><span class="op">(</span>preserve <span class="op">=</span> <span class="st">"single"</span><span class="op">)</span>, width <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_linerange.html" class="external-link">geom_linerange</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>ymin <span class="op">=</span> <span class="va">.lower</span>, ymax <span class="op">=</span> <span class="va">.upper</span><span class="op">)</span>, position <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/position_dodge.html" class="external-link">position_dodge</a></span><span class="op">(</span>width <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_text.html" class="external-link">geom_text</a></span><span class="op">(</span>label <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"Interaction:"</span>, <span class="va">p_val</span><span class="op">)</span>, x <span class="op">=</span> <span class="fl">1.5</span>, y <span class="op">=</span> <span class="fl">7.5</span>, colour <span class="op">=</span> <span class="st">"#666666"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"RelationshipStatus"</span>, y <span class="op">=</span> <span class="st">"ReligiosityCompositeScore"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/lims.html" class="external-link">ylim</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">8.1</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="export-milliways_files/figure-html/unnamed-chunk-3-1.png" width="700"></p>
<p><strong>Note #6:</strong> due to the issues with compiling in the
RMarkdown vignette output format, we only present the results from the
default universe.</p>
</div>
<div class="section level2">
<h2 id="exporting-the-json-files">Exporting the JSON files<a class="anchor" aria-label="anchor" href="#exporting-the-json-files"></a>
</h2>
<p>The current section describes how the remaining three JSON files can
be created. If you haven’t already, the first step would be to execute
all the analyses declared in the multiverse using
<code><a href="../reference/execute.html">execute_multiverse()</a></code>:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/execute.html">execute_multiverse</a></span><span class="op">(</span><span class="va">M</span><span class="op">)</span></span></code></pre></div>
<p>We can then use dedicated functions for each of the JSON files: -
<code>export_results_json</code> or
<code>export_results_dist_json</code>. -
<code>export_code_json</code></p>
<div class="section level3">
<h3 id="exporting-the-results">Exporting the results<a class="anchor" aria-label="anchor" href="#exporting-the-results"></a>
</h3>
<p>We provide two functions to export the results:
<code>export_results_json</code> and
<code>export_results_dist_json</code>. <code>export_results_json</code>
requires the user to specify the following arguments:</p>
<ul>
<li>
<code>term</code>: column name which contains the names of the
outcome variables. For example, in the case of a regression, you could
use the output of <a href="https://generics.r-lib.org/reference/tidy.html" class="external-link">broom::tidy()</a>
and thus the argument would be the column which contains the coefficient
names.</li>
<li>
<code>estimate</code>: column name containing the mean / median
point estimates for each outcome.</li>
<li>
<code>standard error</code>: column name containing the standard
errors for each outcome.</li>
<li>
<code>dist</code>: column name containing distributional objects for
each outcome variable. Optional <strong>only</strong> if
<code>estimate</code> and <code>standard error</code> arguments are
provided. See below for more details.</li>
<li>(optional) <code>filename</code>: if specified, the function will
create a file in the specified path; if not specified, it will return
the dataframe as shown below:</li>
</ul>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/accessors.html">expand</a></span><span class="op">(</span><span class="va">M</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/extract_variables.html">extract_variables</a></span><span class="op">(</span><span class="va">summary_RelComp</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/unnest.html" class="external-link">unnest</a></span><span class="op">(</span> cols <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">summary_RelComp</span><span class="op">)</span> <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span> term <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/recode.html" class="external-link">recode</a></span><span class="op">(</span> <span class="va">term</span>, </span>
<span>                 <span class="st">"RelationshipStatusSingle"</span> <span class="op">=</span> <span class="st">"Single"</span>,</span>
<span>                 <span class="st">"Fertilitylow:RelationshipStatusSingle"</span> <span class="op">=</span> <span class="st">"Single:Fertility_low"</span></span>
<span>  <span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/export_json.html">export_results_json</a></span><span class="op">(</span><span class="va">term</span>, <span class="va">estimate</span>, <span class="va">std.error</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/unnest.html" class="external-link">unnest</a></span><span class="op">(</span><span class="va">results</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">.universe</span>, <span class="va">term</span>, <span class="va">estimate</span>, <span class="va">std.error</span>, <span class="va">cdf.x</span>, <span class="va">cdf.y</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 960 × 6</span></span></span>
<span><span class="co">##    .universe term                 estimate std.error cdf.x       cdf.y      </span></span>
<span><span class="co">##        <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;list&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;list&gt;</span>     </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 1</span>         1 (Intercept)             6.37      0.405 <span style="color: #949494;">&lt;dbl [101]&gt;</span> <span style="color: #949494;">&lt;dbl [101]&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 2</span>         1 Fertilitylow           -<span style="color: #BB0000;">1.16</span>      0.534 <span style="color: #949494;">&lt;dbl [101]&gt;</span> <span style="color: #949494;">&lt;dbl [101]&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 3</span>         1 Single                 -<span style="color: #BB0000;">1.51</span>      0.538 <span style="color: #949494;">&lt;dbl [101]&gt;</span> <span style="color: #949494;">&lt;dbl [101]&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 4</span>         1 Single:Fertility_low    2.05      0.714 <span style="color: #949494;">&lt;dbl [101]&gt;</span> <span style="color: #949494;">&lt;dbl [101]&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 5</span>         2 (Intercept)             5.78      0.322 <span style="color: #949494;">&lt;dbl [101]&gt;</span> <span style="color: #949494;">&lt;dbl [101]&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 6</span>         2 Fertilitylow           -<span style="color: #BB0000;">0.583</span>     0.428 <span style="color: #949494;">&lt;dbl [101]&gt;</span> <span style="color: #949494;">&lt;dbl [101]&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 7</span>         2 Single                 -<span style="color: #BB0000;">0.859</span>     0.583 <span style="color: #949494;">&lt;dbl [101]&gt;</span> <span style="color: #949494;">&lt;dbl [101]&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 8</span>         2 Single:Fertility_low    1.85      0.772 <span style="color: #949494;">&lt;dbl [101]&gt;</span> <span style="color: #949494;">&lt;dbl [101]&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 9</span>         3 (Intercept)             6.37      0.402 <span style="color: #949494;">&lt;dbl [101]&gt;</span> <span style="color: #949494;">&lt;dbl [101]&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">10</span>         3 Fertilitylow           -<span style="color: #BB0000;">1.16</span>      0.531 <span style="color: #949494;">&lt;dbl [101]&gt;</span> <span style="color: #949494;">&lt;dbl [101]&gt;</span></span></span>
<span><span class="co">## <span style="color: #949494;"># ℹ 950 more rows</span></span></span></code></pre>
<p>The resultant JSON file consists of a list of objects (where each
object corresponds to one analysis in the multiverse). Within this
object, the results attribute contains a(nother) list of objects
corresponding to each outcome variable. For e.g., here we have four
coefficients (see the results of the regression model), and thus the
results attribute will contain four objects. Each object has the
following attributes:</p>
<ul>
<li>
<code>term</code>: name of the outcome variable</li>
<li>
<code>estimate</code>: mean / median point estimate i.e., <span class="math inline">\(\mathbb{E}(\mu)\)</span> for any parameter <span class="math inline">\(\mu\)</span>.</li>
<li>
<code>std.error</code>: standard error for the point estimate i.e.,
<span class="math inline">\(\sqrt{\text{var}(\mu)}\)</span>
</li>
<li>
<code>cdf.x</code>: a list of quantiles</li>
<li>
<code>cdf.y</code>: a list of cumulative probability density
estimates corresponding to the quantiles</li>
</ul>
<p>In addition, it also contains the following attributes, but these are
not currently used by Milliways:</p>
<ul>
<li><code>statistic</code></li>
<li><code>p.value</code></li>
<li><code>conf.low</code></li>
<li><code>conf.high</code></li>
</ul>
</div>
<div class="section level3">
<h3 id="a-note-on-distributional-assumptions">A Note on Distributional Assumptions<a class="anchor" aria-label="anchor" href="#a-note-on-distributional-assumptions"></a>
</h3>
<p>For simplicity, we assume that each of the outcome variables follow a
normal distribution. However, this may not always be the case. In this
case, we recommend that you should specify the <code>dist</code>
argument to <code>export_results_json</code> or use the
<code>export_results_dist_json</code> which allows you to specify <a href="https://pkg.mitchelloharawild.com/distributional/" class="external-link">distributional</a>
objects for each outcome. We demonstrate how a user can do this with the
following example of a multiverse analysis where the results consists of
two parameters: <span class="math inline">\(\mu \sim \text{N}(0,
1)\)</span>, a normally distributed random variable and <span class="math inline">\(\sigma \sim \text{exp}(1)\)</span>, a random
variable which follows the exponential distribution.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://tidyr.tidyverse.org/reference/expand_grid.html" class="external-link">expand_grid</a></span><span class="op">(</span></span>
<span>  .universe <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/expand.html" class="external-link">nesting</a></span><span class="op">(</span></span>
<span>    term <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"mu"</span>, <span class="st">"sigma"</span><span class="op">)</span>,</span>
<span>    dist <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu">dist_normal</span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span>, <span class="fu">dist_exponential</span><span class="op">(</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/export_json.html">export_results_dist_json</a></span><span class="op">(</span><span class="va">term</span>, <span class="va">dist</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/unnest.html" class="external-link">unnest</a></span><span class="op">(</span><span class="va">results</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 10 × 5</span></span></span>
<span><span class="co">##    .universe term     dist cdf.x       cdf.y      </span></span>
<span><span class="co">##        <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dist&gt;</span> <span style="color: #949494; font-style: italic;">&lt;list&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;list&gt;</span>     </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 1</span>         1 mu    N(0, 1) <span style="color: #949494;">&lt;dbl [101]&gt;</span> <span style="color: #949494;">&lt;dbl [101]&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 2</span>         1 sigma  Exp(1) <span style="color: #949494;">&lt;dbl [101]&gt;</span> <span style="color: #949494;">&lt;dbl [101]&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 3</span>         2 mu    N(0, 1) <span style="color: #949494;">&lt;dbl [101]&gt;</span> <span style="color: #949494;">&lt;dbl [101]&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 4</span>         2 sigma  Exp(1) <span style="color: #949494;">&lt;dbl [101]&gt;</span> <span style="color: #949494;">&lt;dbl [101]&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 5</span>         3 mu    N(0, 1) <span style="color: #949494;">&lt;dbl [101]&gt;</span> <span style="color: #949494;">&lt;dbl [101]&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 6</span>         3 sigma  Exp(1) <span style="color: #949494;">&lt;dbl [101]&gt;</span> <span style="color: #949494;">&lt;dbl [101]&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 7</span>         4 mu    N(0, 1) <span style="color: #949494;">&lt;dbl [101]&gt;</span> <span style="color: #949494;">&lt;dbl [101]&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 8</span>         4 sigma  Exp(1) <span style="color: #949494;">&lt;dbl [101]&gt;</span> <span style="color: #949494;">&lt;dbl [101]&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 9</span>         5 mu    N(0, 1) <span style="color: #949494;">&lt;dbl [101]&gt;</span> <span style="color: #949494;">&lt;dbl [101]&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">10</span>         5 sigma  Exp(1) <span style="color: #949494;">&lt;dbl [101]&gt;</span> <span style="color: #949494;">&lt;dbl [101]&gt;</span></span></span></code></pre>
</div>
<div class="section level3">
<h3 id="exporting-the-code">Exporting the Code<a class="anchor" aria-label="anchor" href="#exporting-the-code"></a>
</h3>
<p>Exporting the code file is relatively simple as the only arguments
that need to be provided are the multiverse object and file path:</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/export_json.html">export_code_json</a></span><span class="op">(</span><span class="va">M</span>, <span class="st">"code.json"</span><span class="op">)</span></span></code></pre></div>
<p>The JSON file consists of two attributes: <code>code</code> and
<code>parameters</code>. <code>code</code> is a list of strings
consisting of the R and multiverse syntax used to implement the
analysis. For readability, we use <a href="https://styler.r-lib.org/" class="external-link">styler</a> to break up the declared
code. <code>parameters</code> is an object listing the parameter names
and the corresponding options for each of the parameters declared in the
analysis.</p>
</div>
<div class="section level3">
<h3 id="exporting-the-dataset">Exporting the Dataset<a class="anchor" aria-label="anchor" href="#exporting-the-dataset"></a>
</h3>
<p>This function is used to export the (unmodified) dataset that is used
in the analysis, and is a simple wrapper around the
<code>write_json</code> function.</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span> <span class="fu"><a href="../reference/export_json.html">export_data_json</a></span><span class="op">(</span><span class="va">durante</span>, <span class="st">"data.json"</span><span class="op">)</span></span></code></pre></div>
<p>The JSON file consists of a list of objects, each with two
attributes: <code>field</code> and <code>values</code>.
<code>field</code> is the name of a column corresponding to a variable
in the dataset. <code>values</code> are a list of values for that
variable in the dataset.</p>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by <a href="http://abhsarma.github.io" class="external-link">Abhraneel Sarma</a>, <a href="http://www.mjskay.com" class="external-link">Matthew Kay</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.9.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
