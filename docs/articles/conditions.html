<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Declaring conditions in the multiverse • multiverse</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/Nunito_Sans-0.4.10/font.css" rel="stylesheet">
<link href="../deps/Georgia-0.4.10/font.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet">
<meta property="og:title" content="Declaring conditions in the multiverse">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">multiverse</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.6.3</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/branch.html">A discussion on branches in the multiverse</a></li>
    <li><a class="dropdown-item" href="../articles/conditions.html">Declaring conditions in the multiverse</a></li>
    <li><a class="dropdown-item" href="../articles/example-dance.html">Example multiverse implementation: Recreating Adding inferential treatments to plots using Resampling and Animations using multiverse</a></li>
    <li><a class="dropdown-item" href="../articles/example-durante.html">Example multiverse implementation: Effect of fertility on religiosity and political attitudes</a></li>
    <li><a class="dropdown-item" href="../articles/example-frequentist.html">Example multiverse implementation: Re-evaluating the efficiency of physical visualizations</a></li>
    <li><a class="dropdown-item" href="../articles/example-hurricane.html">Example multiverse implementation: Female hurricanes are deadlier than male hurricanes</a></li>
    <li><a class="dropdown-item" href="../articles/execution-multiverse.html">Execution of multiverse analysis: Sequential and Parallel</a></li>
    <li><a class="dropdown-item" href="../articles/export-milliways.html">Exporting the output of a multiverse to JSON for Milliways, a multiverse visualisation tool</a></li>
    <li><a class="dropdown-item" href="../articles/multiverse-in-rmd.html">Using the multiverse in RMarkdown: Introduction to multiverse code chunks</a></li>
    <li><a class="dropdown-item" href="../articles/visualising-multiverse.html">Extracting and Visualising the results of a multiverse analysis</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/MUCollective/multiverse/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Declaring conditions in the multiverse</h1>
                        <h4 data-toc-skip class="author">Abhraneel
Sarma</h4>
            
            <h4 data-toc-skip class="date">2025-10-22</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/MUCollective/multiverse/blob/HEAD/vignettes/conditions.Rmd" class="external-link"><code>vignettes/conditions.Rmd</code></a></small>
      <div class="d-none name"><code>conditions.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://yihui.org/knitr/" class="external-link">knitr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyr.tidyverse.org" class="external-link">tidyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://purrr.tidyverse.org/" class="external-link">purrr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://broom.tidymodels.org/" class="external-link">broom</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://gganimate.com" class="external-link">gganimate</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://wilkelab.org/cowplot/" class="external-link">cowplot</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://mucollective.github.io/multiverse/">multiverse</a></span><span class="op">)</span></span></code></pre></div>
<div class="section level2">
<h2 id="the-data">The data<a class="anchor" aria-label="anchor" href="#the-data"></a>
</h2>
<p>We will be using the same data as the vignette: <em>A complete
implementation of a multiverse analysis</em> (see
<code><a href="../articles/example-durante.html">vignette("example-durante")</a></code>).</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"durante"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">df_durante</span> <span class="op">&lt;-</span> <span class="va">durante</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>    Abortion <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="fl">7</span> <span class="op">-</span> <span class="va">Abortion</span><span class="op">)</span> <span class="op">+</span> <span class="fl">1</span>,</span>
<span>    StemCell <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="fl">7</span> <span class="op">-</span> <span class="va">StemCell</span><span class="op">)</span> <span class="op">+</span> <span class="fl">1</span>,</span>
<span>    Marijuana <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="fl">7</span> <span class="op">-</span> <span class="va">Marijuana</span><span class="op">)</span> <span class="op">+</span> <span class="fl">1</span>,</span>
<span>    RichTax <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="fl">7</span> <span class="op">-</span> <span class="va">RichTax</span><span class="op">)</span> <span class="op">+</span> <span class="fl">1</span>,</span>
<span>    StLiving <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="fl">7</span> <span class="op">-</span> <span class="va">StLiving</span><span class="op">)</span> <span class="op">+</span> <span class="fl">1</span>,</span>
<span>    Profit <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="fl">7</span> <span class="op">-</span> <span class="va">Profit</span><span class="op">)</span> <span class="op">+</span> <span class="fl">1</span>,</span>
<span>    FiscConsComp <span class="op">=</span> <span class="va">FreeMarket</span> <span class="op">+</span> <span class="va">PrivSocialSec</span> <span class="op">+</span> <span class="va">RichTax</span> <span class="op">+</span> <span class="va">StLiving</span> <span class="op">+</span> <span class="va">Profit</span>,</span>
<span>    SocConsComp <span class="op">=</span> <span class="va">Marriage</span> <span class="op">+</span> <span class="va">RestrictAbortion</span> <span class="op">+</span> <span class="va">Abortion</span> <span class="op">+</span> <span class="va">StemCell</span> <span class="op">+</span> <span class="va">Marijuana</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="specifying-conditions-in-the-multiverse-analysis">Specifying conditions in the multiverse analysis<a class="anchor" aria-label="anchor" href="#specifying-conditions-in-the-multiverse-analysis"></a>
</h2>
<p>In a multiverse analysis, it may occur that the value of one variable
might depend on the value of another variable defined previously. For
example, in our example, we are excluding participants based on their
<em>cycle length</em>. This can be done in two ways: we can use the
values of the variable,<code>ComputedCycleLength</code> or
<code>ReportedCycleLength</code>. If we are using
<code>ComputedCycleLength</code> to exclude participants, this means
that we should not calculate the variable
<code>NextMenstrualOnset</code> (date for the onset of the next
menstrual cycle) using the <code>ReportedCycleLength</code> value.
Similarly, if we are using <code>ReportedCycleLength</code> to exclude
participants it is inconsistent to calculate
<code>NextMenstrualOnset</code> using
<code>ComputedCycleLength</code>.</p>
<p>We should be able to express these conditions in the multiverse. We
can do this in two ways: 1. <code>%when%</code>: when declaring a
branch, we can use this operator to specify the conditional
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><mo stretchy="false" form="prefix">|</mo><mi>B</mi></mrow><annotation encoding="application/x-tex">A | B</annotation></semantics></math>
as <code>A %when% B</code>. The conditional
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><mo stretchy="false" form="prefix">|</mo><mi>B</mi></mrow><annotation encoding="application/x-tex">A | B</annotation></semantics></math>
is also referred to as the connective
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><mo>⟹</mo><mi>B</mi></mrow><annotation encoding="application/x-tex">A \implies B</annotation></semantics></math>.
This has the meaning “if A is true, then B is also true” and is an
abbreviation for
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>¬</mo><mi>A</mi><mo stretchy="false" form="prefix">|</mo><mi>B</mi></mrow><annotation encoding="application/x-tex">\neg A | B</annotation></semantics></math>
2. <code>branch_assert</code>: this function allows the user to specify
any condition in the form of a logical operation</p>
<div class="section level4">
<h4 id="the-when-operator">The <code>%when%</code> operator<a class="anchor" aria-label="anchor" href="#the-when-operator"></a>
</h4>
<p>There are two ways in which you can specify the <code>%when%</code>
operator. The first is to specify it at the end of the branch. This will
work even if you omit the branch option name.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">df</span> <span class="op">&lt;-</span> <span class="va">df</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>NextMenstrualOnset <span class="op">=</span> <span class="fu"><a href="../reference/branch.html">branch</a></span><span class="op">(</span><span class="va">menstrual_calculation</span>,</span>
<span>        <span class="st">"mc_option1"</span> <span class="op">~</span> <span class="op">(</span><span class="va">StartDateofLastPeriod</span> <span class="op">+</span> <span class="va">ComputedCycleLength</span><span class="op">)</span> <span class="op"><a href="../reference/conditionals.html">%when%</a></span> <span class="op">(</span><span class="va">cycle_length</span> <span class="op">!=</span> <span class="st">"cl_option3"</span><span class="op">)</span>,</span>
<span>        <span class="st">"mc_option2"</span> <span class="op">~</span> <span class="op">(</span><span class="va">StartDateofLastPeriod</span> <span class="op">+</span> <span class="va">ReportedCycleLength</span><span class="op">)</span> <span class="op"><a href="../reference/conditionals.html">%when%</a></span> <span class="op">(</span><span class="va">cycle_length</span> <span class="op">!=</span> <span class="st">"cl_option2"</span><span class="op">)</span>,</span>
<span>        <span class="st">"mc_option3"</span> <span class="op">~</span> <span class="va">StartDateNext</span><span class="op">)</span></span>
<span>    <span class="op">)</span></span></code></pre></div>
<p>The other is to specify it at the head of the branch, right after the
option name:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">df</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>NextMenstrualOnset <span class="op">=</span> <span class="fu"><a href="../reference/branch.html">branch</a></span><span class="op">(</span><span class="va">menstrual_calculation</span>,</span>
<span>        <span class="st">"mc_option1"</span> <span class="op"><a href="../reference/conditionals.html">%when%</a></span> <span class="op">(</span><span class="va">cycle_length</span> <span class="op">!=</span> <span class="st">"cl_option3"</span><span class="op">)</span> <span class="op">~</span> <span class="va">StartDateofLastPeriod</span> <span class="op">+</span> <span class="va">ComputedCycleLength</span>,</span>
<span>        <span class="st">"mc_option2"</span> <span class="op"><a href="../reference/conditionals.html">%when%</a></span> <span class="op">(</span><span class="va">cycle_length</span> <span class="op">!=</span> <span class="st">"cl_option2"</span><span class="op">)</span> <span class="op">~</span> <span class="op">(</span><span class="va">StartDateofLastPeriod</span> <span class="op">+</span> <span class="va">ReportedCycleLength</span><span class="op">)</span>,</span>
<span>        <span class="st">"mc_option3"</span> <span class="op">~</span> <span class="va">StartDateNext</span><span class="op">)</span></span>
<span>    <span class="op">)</span></span></code></pre></div>
<p><strong>Note</strong>: In this example we will be using the
<code>inside</code> syntax to enter code into the multiverse, instead of
<em>multiverse code blocks</em> to highlight the syntax of the
conditional declaration as <em>multiverse code blocks</em> shows the
code for a universe, and hides the actual code declared by the user.</p>
<p>We can write the complete analysis by specifying the condition with
the %when% operator as:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">M</span> <span class="op">=</span> <span class="fu"><a href="../reference/multiverse.html">multiverse</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/inside.html">inside</a></span><span class="op">(</span><span class="va">M</span>, <span class="op">{</span></span>
<span>  <span class="va">df.1</span> <span class="op">&lt;-</span> <span class="va">df_durante</span>  <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>      <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span> ComputedCycleLength <span class="op">=</span> <span class="va">StartDateofLastPeriod</span> <span class="op">-</span> <span class="va">StartDateofPeriodBeforeLast</span> <span class="op">)</span>  <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>      <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span> <span class="fu"><a href="../reference/branch.html">branch</a></span><span class="op">(</span><span class="va">cycle_length</span>,</span>
<span>          <span class="st">"cl_option1"</span> <span class="op">~</span> <span class="cn">TRUE</span>,</span>
<span>          <span class="st">"cl_option2"</span> <span class="op">~</span> <span class="va">ComputedCycleLength</span> <span class="op">&gt;</span> <span class="fl">25</span> <span class="op">&amp;</span> <span class="va">ComputedCycleLength</span> <span class="op">&lt;</span> <span class="fl">35</span>,</span>
<span>          <span class="st">"cl_option3"</span> <span class="op">~</span> <span class="va">ReportedCycleLength</span> <span class="op">&gt;</span> <span class="fl">25</span> <span class="op">&amp;</span> <span class="va">ReportedCycleLength</span> <span class="op">&lt;</span> <span class="fl">35</span></span>
<span>      <span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>      <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>NextMenstrualOnset <span class="op">=</span> <span class="fu"><a href="../reference/branch.html">branch</a></span><span class="op">(</span><span class="va">menstrual_calculation</span>,</span>
<span>          <span class="st">"mc_option1"</span> <span class="op"><a href="../reference/conditionals.html">%when%</a></span> <span class="op">(</span><span class="va">cycle_length</span> <span class="op">!=</span> <span class="st">"cl_option3"</span><span class="op">)</span> <span class="op">~</span> <span class="va">StartDateofLastPeriod</span> <span class="op">+</span> <span class="va">ComputedCycleLength</span>,</span>
<span>          <span class="st">"mc_option2"</span> <span class="op"><a href="../reference/conditionals.html">%when%</a></span> <span class="op">(</span><span class="va">cycle_length</span> <span class="op">!=</span> <span class="st">"cl_option2"</span><span class="op">)</span> <span class="op">~</span> <span class="va">StartDateofLastPeriod</span> <span class="op">+</span> <span class="va">ReportedCycleLength</span>,</span>
<span>          <span class="st">"mc_option3"</span> <span class="op">~</span> <span class="va">StartDateNext</span><span class="op">)</span></span>
<span>      <span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span></span></code></pre></div>
<p>In <code>multiverse code chunks</code> conditionals can be declared
in pretty much the same way:</p>
<pre><code>```{multiverse default-m-1, inside = M}
df &lt;- df_durante  %&gt;%
      mutate( ComputedCycleLength = StartDateofLastPeriod - StartDateofPeriodBeforeLast )  %&gt;%
      dplyr::filter( branch(cycle_length,
          "cl_option1" ~ TRUE,
          "cl_option2" ~ ComputedCycleLength &gt; 25 &amp; ComputedCycleLength &lt; 35,
          "cl_option3" ~ ReportedCycleLength &gt; 25 &amp; ReportedCycleLength &lt; 35
      )) %&gt;%
      mutate(NextMenstrualOnset = branch(menstrual_calculation,
          "mc_option1" %when% (cycle_length != "cl_option3") ~ StartDateofLastPeriod + ComputedCycleLength,
          "mc_option2" %when% (cycle_length != "cl_option2") ~ StartDateofLastPeriod + ReportedCycleLength,
          "mc_option3" ~ StartDateNext)
      )
```</code></pre>
<p><strong>Note</strong>: in this vignette we used the script-oriented
<code><a href="../reference/inside.html">inside()</a></code> function for implementing the multiverse. However,
we can implement the exact same multiverse in RMarkdown using the
<code>multiverse-code-block</code> for more interactive programming. To
implement this using a <code>multiverse-code-block</code>, we can simply
place the code passed into the inside function (the second argument)
inside a code block of type <code>multiverse</code>, provide it with the
appropriate labels and multiverse object, and execute it. See
(multiverse-in-rmd) and (branch) for more details and examples.</p>
<p>As the condition implies, the parameter
<code>menstrual_calcaultion</code> (which is for calculating the
variable <code>NextMenstrualCalculation</code>) cannot take the value of
“mc_option1” when we filter <code>cycle_length</code> using
“cl_option3”. Similarly, <code>menstrual_calcaultion</code> cannot take
the value of “mc_option2” when we filter <code>cycle_length</code> using
“cl_option2”. In the multiverse table below, you can see that those two
parameter combinations are absent (universes indexed 3 and 5.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/accessors.html">expand</a></span><span class="op">(</span><span class="va">M</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 7 × 7</span></span></span>
<span><span class="co">##   .universe cycle_length menstrual_calculation .parameter_assignment</span></span>
<span><span class="co">##       <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                 <span style="color: #949494; font-style: italic;">&lt;list&gt;</span>               </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span>         1 cl_option1   mc_option1            <span style="color: #949494;">&lt;named list [2]&gt;</span>     </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">2</span>         2 cl_option1   mc_option2            <span style="color: #949494;">&lt;named list [2]&gt;</span>     </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">3</span>         3 cl_option1   mc_option3            <span style="color: #949494;">&lt;named list [2]&gt;</span>     </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">4</span>         4 cl_option2   mc_option1            <span style="color: #949494;">&lt;named list [2]&gt;</span>     </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">5</span>         5 cl_option2   mc_option3            <span style="color: #949494;">&lt;named list [2]&gt;</span>     </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">6</span>         6 cl_option3   mc_option2            <span style="color: #949494;">&lt;named list [2]&gt;</span>     </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">7</span>         7 cl_option3   mc_option3            <span style="color: #949494;">&lt;named list [2]&gt;</span>     </span></span>
<span><span class="co">## <span style="color: #949494;"># ℹ 3 more variables: .code &lt;list&gt;, .results &lt;list&gt;, .errors &lt;list&gt;</span></span></span></code></pre>
</div>
</div>
<div class="section level2">
<h2 id="implementing-conditions-in-a-complete-analysis">Implementing conditions in a complete analysis<a class="anchor" aria-label="anchor" href="#implementing-conditions-in-a-complete-analysis"></a>
</h2>
<p>Specifying these conditions allows us to exclude inconsistent
combinations from our analyses. Let’s update the example from <a href="https://mucollective.github.io/multiverse/">home page</a> by
including these conditions:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">M</span> <span class="op">=</span> <span class="fu"><a href="../reference/multiverse.html">multiverse</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code>```{multiverse default-m-2, inside = M, echo = FALSE}
df &lt;- df_durante  %&gt;%
  mutate( ComputedCycleLength = StartDateofLastPeriod - StartDateofPeriodBeforeLast )  %&gt;%
  dplyr::filter( branch(cycle_length,
          "cl_option1" ~ TRUE,
          "cl_option2" ~ ComputedCycleLength &gt; 25 &amp; ComputedCycleLength &lt; 35,
          "cl_option3" ~ ReportedCycleLength &gt; 25 &amp; ReportedCycleLength &lt; 35
  )) %&gt;%
  dplyr::filter( branch(certainty,
          "cer_option1" ~ TRUE,
          "cer_option2" ~ Sure1 &gt; 6 | Sure2 &gt; 6
  )) %&gt;%
  mutate(NextMenstrualOnset = branch(menstrual_calculation,
          "mc_option1" %when% (cycle_length != "cl_option3") ~ StartDateofLastPeriod + ComputedCycleLength,
          "mc_option2" %when% (cycle_length != "cl_option2") ~ StartDateofLastPeriod + ReportedCycleLength,
          "mc_option3" ~ StartDateNext)
  )  %&gt;%
  mutate(
    CycleDay = 28 - (NextMenstrualOnset - DateTesting),
    CycleDay = ifelse(CycleDay &gt; 1 &amp; CycleDay &lt; 28, CycleDay, ifelse(CycleDay &lt; 1, 1, 28))
  ) %&gt;%
  mutate( Fertility = branch( fertile,
          "fer_option1" ~ factor( ifelse(CycleDay &gt;= 7 &amp; CycleDay &lt;= 14, "high", ifelse(CycleDay &gt;= 17 &amp; CycleDay &lt;= 25, "low", NA)) ),
          "fer_option2" ~ factor( ifelse(CycleDay &gt;= 6 &amp; CycleDay &lt;= 14, "high", ifelse(CycleDay &gt;= 17 &amp; CycleDay &lt;= 27, "low", NA)) ),
          "fer_option3" ~ factor( ifelse(CycleDay &gt;= 9 &amp; CycleDay &lt;= 17, "high", ifelse(CycleDay &gt;= 18 &amp; CycleDay &lt;= 25, "low", NA)) ),
          "fer_option4" ~ factor( ifelse(CycleDay &gt;= 8 &amp; CycleDay &lt;= 14, "high", "low") ),
          "fer_option45" ~ factor( ifelse(CycleDay &gt;= 8 &amp; CycleDay &lt;= 17, "high", "low") )
  )) %&gt;%
  mutate(RelationshipStatus = branch(relationship_status,
          "rs_option1" ~ factor(ifelse(Relationship==1 | Relationship==2, 'Single', 'Relationship')),
          "rs_option2" ~ factor(ifelse(Relationship==1, 'Single', 'Relationship')),
          "rs_option3" ~ factor(ifelse(Relationship==1, 'Single', ifelse(Relationship==3 | Relationship==4, 'Relationship', NA))) )
  )
```</code></pre>
<p>After excluding the inconsistent choice combinations,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>270</mn><mo>−</mo><mn>2</mn><mo>×</mo><mrow><mo stretchy="true" form="prefix">(</mo><mn>5</mn><mo>×</mo><mn>1</mn><mo>×</mo><mn>3</mn><mo>×</mo><mn>1</mn><mo>×</mo><mn>2</mn><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mn>210</mn></mrow><annotation encoding="application/x-tex">270 − 2 \times (5 \times 1 \times 3 \times 1 \times 2) = 210</annotation></semantics></math>
choice combinations remain:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/accessors.html">expand</a></span><span class="op">(</span><span class="va">M</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 210</span></span></code></pre>
<p>Now, we’ve created the complete multiverse that was presented as
example #2 from Steegen et al.’s paper.</p>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by <a href="http://abhsarma.github.io" class="external-link">Abhraneel Sarma</a>, <a href="http://www.mjskay.com" class="external-link">Matthew Kay</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
