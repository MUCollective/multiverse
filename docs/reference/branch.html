<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Define multiple analysis paths for a step in the multiverse — branch • multiverse</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/lumen/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet"><meta property="og:title" content="Define multiple analysis paths for a step in the multiverse — branch"><meta property="og:description" content="The branch function allows the user to define multiple analysis options for a particular step
in the analysis."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">multiverse</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.6.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/branch.html">A discussion on branches in the multiverse</a>
    </li>
    <li>
      <a href="../articles/conditions.html">Declaring conditions in the multiverse</a>
    </li>
    <li>
      <a href="../articles/durante-multiverse-analysis.html">Example multiverse implementation: Effect of fertility on religiosity and political attitudes</a>
    </li>
    <li>
      <a href="../articles/execution-multiverse.html">Execution of multiverse analysis --- Sequential and Parallel</a>
    </li>
    <li>
      <a href="../articles/frequentist-multiverse-analysis.html">Example multiverse implementation: Re-evaluating the efficiency of physical visualizations</a>
    </li>
    <li>
      <a href="../articles/hurricane.html">Example multiverse implementation: Female hurricanes are deadlier than male hurricanes</a>
    </li>
    <li>
      <a href="../articles/multiverse-in-rmd.html">Using the multiverse in RMarkdown: Introduction to multiverse code chunks</a>
    </li>
    <li>
      <a href="../articles/visualising-multiverse.html">Extracting and Visualising the results of a multiverse analysis</a>
    </li>
  </ul></li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/MUCollective/multiverse/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Define multiple analysis paths for a step in the multiverse</h1>
    <small class="dont-index">Source: <a href="https://github.com/MUCollective/multiverse/blob/HEAD/R/branch.R" class="external-link"><code>R/branch.R</code></a></small>
    <div class="hidden name"><code>branch.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>The <code>branch</code> function allows the user to define multiple analysis options for a particular step
in the analysis.</p>
    </div>


    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>parameter</dt>
<dd><p>A string to identify the branch. Each branch is characterised using a
parameter which takes different options.</p></dd>
<dt>...</dt>
<dd><p>Different options for completing a particular step in the analysis. Each option is
declared as &lt;option_name&gt; ~ &lt;option_calculation&gt;. See examples for more details.</p></dd>
<dt>.options</dt>
<dd><p>Declare a continuous value as the option of a parameter using a sequence 
(see examples for details), and the expanded sequence will be included as options for that
parameter in the multiverse.</p></dd>
</dl></div>
    <div id="details">
    <h2>Details</h2>
    <p>For every step in the analysis, there may be more than one analysis option. 
We use <code>branch</code> to declare these different analysis options. Each branch is
characterised by a parameter. The first argument passed into the branch is the parameter.</p>
<p>All the other arguments passed into branch are the different analysis options corresponding 
to that parameter (that particular step in the analysis process). Naturally, at least two 
or more options should be declared. Thus, the branch function will provide a warning
if the total number arguments passed is less than three.</p>
<p>Please refer to <code><a href="../articles/branch.html">vignette("branch")</a></code> for more details on how to use this function to 
create a complete multiverse analysis.</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span class="co"># \donttest{</span></span>
<span class="r-in"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Attaching package: ‘dplyr’</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> The following objects are masked from ‘package:stats’:</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>     filter, lag</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> The following objects are masked from ‘package:base’:</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>     intersect, setdiff, setequal, union</span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># Example 1: declaring multiple options for a data processing step </span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span>
<span class="r-in"><span class="va">x</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">100</span>, <span class="fl">30</span>, <span class="fl">10</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># Say that you have a variable, x. You want to discretise this variable into two ordinal </span></span>
<span class="r-in"><span class="co"># categories — high (if x &gt;= 30) and low (if x &lt; 30). However, another researcher might argue </span></span>
<span class="r-in"><span class="co"># for discretising this variable into three ordinal categories — high (if x &gt;= 40), </span></span>
<span class="r-in"><span class="co"># medium (if 20 &lt;= x &lt; 40), and low (if x &lt; 20).</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="va">M.1</span> <span class="op">=</span> <span class="fu"><a href="multiverse.html">multiverse</a></span><span class="op">(</span><span class="op">)</span> <span class="co"># create a new multiverse object</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="fu"><a href="inside.html">inside</a></span><span class="op">(</span><span class="va">M.1</span>, <span class="op">{</span></span>
<span class="r-in"><span class="va">y</span> <span class="op">=</span> <span class="fu">branch</span><span class="op">(</span><span class="va">discretisation</span>, </span>
<span class="r-in">        <span class="st">"two_levels"</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">x</span> <span class="op">&lt;</span> <span class="fl">30</span>, <span class="st">"low"</span>, <span class="st">"high"</span><span class="op">)</span>,</span>
<span class="r-in">        <span class="st">"three_levels"</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">x</span> <span class="op">&lt;</span> <span class="fl">20</span>, <span class="st">"low"</span>, <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">x</span> <span class="op">&gt;</span> <span class="fl">40</span>, <span class="st">"high"</span>, <span class="st">"medium"</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-in">    <span class="op">)</span></span>
<span class="r-in"><span class="op">}</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># Example 2: using branch with tidyverse and `%&gt;%`</span></span>
<span class="r-in"><span class="co"># Let’s say that we have some data which indicates the amount of time spent by a user</span></span>
<span class="r-in"><span class="co"># in four different conditions which are indexed 1, 2, 3 and 4</span></span>
<span class="r-in"><span class="co"># (the modality column in the following dataset). </span></span>
<span class="r-in"><span class="co"># We will first load the data and convert the column into factor from integer.</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"userlogs"</span><span class="op">)</span></span>
<span class="r-in"><span class="va">data.userlogs.raw</span> <span class="op">=</span> <span class="va">userlogs</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span class="r-in">    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span> modality <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">modality</span><span class="op">)</span> <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span class="r-in">    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html" class="external-link">arrange</a></span><span class="op">(</span> <span class="va">modality</span> <span class="op">)</span></span>
<span class="r-in">    </span>
<span class="r-in"><span class="va">M.2</span> <span class="op">=</span> <span class="fu"><a href="multiverse.html">multiverse</a></span><span class="op">(</span><span class="op">)</span> <span class="co"># create a new multiverse object</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="fu"><a href="inside.html">inside</a></span><span class="op">(</span><span class="va">M.2</span>, <span class="op">{</span></span>
<span class="r-in">    <span class="va">df</span> <span class="op">=</span> <span class="va">data.userlogs.raw</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span class="r-in">        <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">modality</span>, <span class="va">duration</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span class="r-in">        <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span> duration <span class="op">=</span> <span class="fu">branch</span><span class="op">(</span> <span class="va">data_transform</span>, </span>
<span class="r-in">                            <span class="st">"none"</span> <span class="op">~</span> <span class="va">duration</span>,</span>
<span class="r-in">                            <span class="st">"log"</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">duration</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-in"><span class="op">}</span><span class="op">)</span>                             </span>
<span class="r-in"></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># Example 3: using branch with tidyverse and `%&gt;%`</span></span>
<span class="r-in"><span class="co"># Consider a scenario where there are more than one alternatives to</span></span>
<span class="r-in"><span class="co"># identifying and removing outliers</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"hurricane"</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="va">M.3</span> <span class="op">=</span> <span class="fu"><a href="multiverse.html">multiverse</a></span><span class="op">(</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># here, we perform a `filter` operation in the multiverse</span></span>
<span class="r-in"><span class="fu"><a href="inside.html">inside</a></span><span class="op">(</span><span class="va">M.3</span>, <span class="op">{</span></span>
<span class="r-in">    <span class="va">df.filtered</span> <span class="op">=</span> <span class="va">hurricane</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span class="r-in">        <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="fu">branch</span><span class="op">(</span><span class="va">death_outliers</span>,</span>
<span class="r-in">                   <span class="st">"no_exclusion"</span> <span class="op">~</span> <span class="cn">TRUE</span>,</span>
<span class="r-in">                   <span class="st">"most_extreme"</span> <span class="op">~</span> <span class="va">name</span> <span class="op">!=</span> <span class="st">"Katrina"</span>,</span>
<span class="r-in">                   <span class="st">"two_most_extreme"</span> <span class="op">~</span> <span class="op">!</span><span class="op">(</span><span class="va">name</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Katrina"</span>, <span class="st">"Audrey"</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-in">    <span class="op">)</span><span class="op">)</span></span>
<span class="r-in"><span class="op">}</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># Example 4: using branch as a function</span></span>
<span class="r-in"><span class="co"># An alternate way of implementing the `branch()` function from Example 2 may be:</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="va">M.4</span> <span class="op">=</span> <span class="fu"><a href="multiverse.html">multiverse</a></span><span class="op">(</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="fu"><a href="inside.html">inside</a></span><span class="op">(</span><span class="va">M.4</span>, <span class="op">{</span></span>
<span class="r-in">    <span class="va">duration_transform</span> <span class="op">=</span> <span class="fu">branch</span><span class="op">(</span><span class="va">data_trans</span>,</span>
<span class="r-in">        <span class="st">"log-transformed"</span> <span class="op">~</span> <span class="va">log</span>,</span>
<span class="r-in">        <span class="st">"un-transformed"</span> <span class="op">~</span> <span class="va">identity</span></span>
<span class="r-in">    <span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in">    <span class="va">duration</span> <span class="op">=</span> <span class="fu">duration_transform</span><span class="op">(</span><span class="va">data.userlogs.raw</span><span class="op">$</span><span class="va">duration</span><span class="op">)</span></span>
<span class="r-in"><span class="op">}</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># Example 5: continuous option values for a parameter</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="va">M.5</span> <span class="op">=</span> <span class="fu"><a href="multiverse.html">multiverse</a></span><span class="op">(</span><span class="op">)</span></span>
<span class="r-in"><span class="fu"><a href="inside.html">inside</a></span><span class="op">(</span><span class="va">M.5</span>, <span class="op">{</span></span>
<span class="r-in">  <span class="fu">branch</span><span class="op">(</span><span class="va">foo</span>, <span class="st">"option1"</span> <span class="op">~</span> <span class="fl">1</span>, .options <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">)</span></span>
<span class="r-in"><span class="op">}</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="va">M.6</span> <span class="op">=</span> <span class="fu"><a href="multiverse.html">multiverse</a></span><span class="op">(</span><span class="op">)</span></span>
<span class="r-in"><span class="co"># alternatively, we could specify how we want the vector to be expanded</span></span>
<span class="r-in"><span class="co"># for continuous parameters</span></span>
<span class="r-in"><span class="fu"><a href="inside.html">inside</a></span><span class="op">(</span><span class="va">M.6</span>, <span class="op">{</span></span>
<span class="r-in">  <span class="fu">branch</span><span class="op">(</span><span class="va">foo</span>, <span class="st">"option1"</span> <span class="op">~</span> <span class="fl">1</span>, .options <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span>, by <span class="op">=</span> <span class="fl">0.1</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-in"><span class="op">}</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># }</span></span>
<span class="r-in"></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by <a href="http://abhsarma.github.io" class="external-link">Abhraneel Sarma</a>, <a href="http://www.mjskay.com" class="external-link">Matthew Kay</a>.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.3.</p>
</div>

      </footer></div>

  


  

  </body></html>

