<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Define multiple analysis paths for a step in the multiverse — branch • multiverse</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/Nunito_Sans-0.4.9/font.css" rel="stylesheet"><link href="../deps/Georgia-0.4.9/font.css" rel="stylesheet"><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet"><meta property="og:title" content="Define multiple analysis paths for a step in the multiverse — branch"><meta name="description" content="The branch function allows the user to define multiple analysis options for a particular step
in the analysis."><meta property="og:description" content="The branch function allows the user to define multiple analysis options for a particular step
in the analysis."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">multiverse</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.6.2.2</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/branch.html">A discussion on branches in the multiverse</a></li>
    <li><a class="dropdown-item" href="../articles/conditions.html">Declaring conditions in the multiverse</a></li>
    <li><a class="dropdown-item" href="../articles/example-dance.html">Example multiverse implementation: Recreating Adding inferential treatments to plots using Resampling and Animations using multiverse</a></li>
    <li><a class="dropdown-item" href="../articles/example-durante.html">Example multiverse implementation: Effect of fertility on religiosity and political attitudes</a></li>
    <li><a class="dropdown-item" href="../articles/example-frequentist.html">Example multiverse implementation: Re-evaluating the efficiency of physical visualizations</a></li>
    <li><a class="dropdown-item" href="../articles/example-hurricane.html">Example multiverse implementation: Female hurricanes are deadlier than male hurricanes</a></li>
    <li><a class="dropdown-item" href="../articles/execution-multiverse.html">Execution of multiverse analysis: Sequential and Parallel</a></li>
    <li><a class="dropdown-item" href="../articles/export-milliways.html">Exporting the output of a multiverse to JSON for Milliways, a multiverse visualisation tool</a></li>
    <li><a class="dropdown-item" href="../articles/multiverse-in-rmd.html">Using the multiverse in RMarkdown: Introduction to multiverse code chunks</a></li>
    <li><a class="dropdown-item" href="../articles/visualising-multiverse.html">Extracting and Visualising the results of a multiverse analysis</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/MUCollective/multiverse/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Define multiple analysis paths for a step in the multiverse</h1>
      <small class="dont-index">Source: <a href="https://github.com/MUCollective/multiverse/blob/HEAD/R/branch.R" class="external-link"><code>R/branch.R</code></a></small>
      <div class="d-none name"><code>branch.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>The <code>branch</code> function allows the user to define multiple analysis options for a particular step
in the analysis.</p>
    </div>


    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-parameter">parameter<a class="anchor" aria-label="anchor" href="#arg-parameter"></a></dt>
<dd><p>A string to identify the branch. Each branch is characterised using a
parameter which takes different options.</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>Different options for completing a particular step in the analysis. Each option is
declared as &lt;option_name&gt; ~ &lt;option_calculation&gt;. See examples for more details.</p></dd>


<dt id="arg--options">.options<a class="anchor" aria-label="anchor" href="#arg--options"></a></dt>
<dd><p>Declare a continuous value as the option of a parameter using a sequence
(see examples for details), and the expanded sequence will be included as options for that
parameter in the multiverse.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>For every step in the analysis, there may be more than one analysis option.
We use <code>branch</code> to declare these different analysis options. Each branch is
characterised by a parameter. The first argument passed into the branch is the parameter.</p>
<p>All the other arguments passed into branch are the different analysis options corresponding
to that parameter (that particular step in the analysis process). Naturally, at least two
or more options should be declared. Thus, the branch function will provide a warning
if the total number arguments passed is less than three.</p>
<p>Please refer to <code><a href="../articles/branch.html">vignette("branch")</a></code> for more details on how to use this function to
create a complete multiverse analysis.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># \donttest{</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Attaching package: ‘dplyr’</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> The following objects are masked from ‘package:stats’:</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>     filter, lag</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> The following objects are masked from ‘package:base’:</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>     intersect, setdiff, setequal, union</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Example 1: declaring multiple options for a data processing step </span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">x</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">100</span>, <span class="fl">30</span>, <span class="fl">10</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Say that you have a variable, x. You want to discretise this variable into two ordinal </span></span></span>
<span class="r-in"><span><span class="co"># categories — high (if x &gt;= 30) and low (if x &lt; 30). However, another researcher might argue </span></span></span>
<span class="r-in"><span><span class="co"># for discretising this variable into three ordinal categories — high (if x &gt;= 40), </span></span></span>
<span class="r-in"><span><span class="co"># medium (if 20 &lt;= x &lt; 40), and low (if x &lt; 20).</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">M.1</span> <span class="op">=</span> <span class="fu"><a href="multiverse.html">multiverse</a></span><span class="op">(</span><span class="op">)</span> <span class="co"># create a new multiverse object</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="inside.html">inside</a></span><span class="op">(</span><span class="va">M.1</span>, <span class="op">{</span></span></span>
<span class="r-in"><span><span class="va">y</span> <span class="op">=</span> <span class="fu">branch</span><span class="op">(</span><span class="va">discretisation</span>, </span></span>
<span class="r-in"><span>        <span class="st">"two_levels"</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">x</span> <span class="op">&lt;</span> <span class="fl">30</span>, <span class="st">"low"</span>, <span class="st">"high"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>        <span class="st">"three_levels"</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">x</span> <span class="op">&lt;</span> <span class="fl">20</span>, <span class="st">"low"</span>, <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">x</span> <span class="op">&gt;</span> <span class="fl">40</span>, <span class="st">"high"</span>, <span class="st">"medium"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Example 2: using branch with tidyverse and `%&gt;%`</span></span></span>
<span class="r-in"><span><span class="co"># Let’s say that we have some data which indicates the amount of time spent by a user</span></span></span>
<span class="r-in"><span><span class="co"># in four different conditions which are indexed 1, 2, 3 and 4</span></span></span>
<span class="r-in"><span><span class="co"># (the modality column in the following dataset). </span></span></span>
<span class="r-in"><span><span class="co"># We will first load the data and convert the column into factor from integer.</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"userlogs"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">data.userlogs.raw</span> <span class="op">=</span> <span class="va">userlogs</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span> modality <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">modality</span><span class="op">)</span> <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html" class="external-link">arrange</a></span><span class="op">(</span> <span class="va">modality</span> <span class="op">)</span></span></span>
<span class="r-in"><span>    </span></span>
<span class="r-in"><span><span class="va">M.2</span> <span class="op">=</span> <span class="fu"><a href="multiverse.html">multiverse</a></span><span class="op">(</span><span class="op">)</span> <span class="co"># create a new multiverse object</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="inside.html">inside</a></span><span class="op">(</span><span class="va">M.2</span>, <span class="op">{</span></span></span>
<span class="r-in"><span>    <span class="va">df</span> <span class="op">=</span> <span class="va">data.userlogs.raw</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span></span>
<span class="r-in"><span>        <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">modality</span>, <span class="va">duration</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span></span>
<span class="r-in"><span>        <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span> duration <span class="op">=</span> <span class="fu">branch</span><span class="op">(</span> <span class="va">data_transform</span>, </span></span>
<span class="r-in"><span>                            <span class="st">"none"</span> <span class="op">~</span> <span class="va">duration</span>,</span></span>
<span class="r-in"><span>                            <span class="st">"log"</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">duration</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span><span class="op">)</span>                             </span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Example 3: using branch with tidyverse and `%&gt;%`</span></span></span>
<span class="r-in"><span><span class="co"># Consider a scenario where there are more than one alternatives to</span></span></span>
<span class="r-in"><span><span class="co"># identifying and removing outliers</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"hurricane"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">M.3</span> <span class="op">=</span> <span class="fu"><a href="multiverse.html">multiverse</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># here, we perform a `filter` operation in the multiverse</span></span></span>
<span class="r-in"><span><span class="fu"><a href="inside.html">inside</a></span><span class="op">(</span><span class="va">M.3</span>, <span class="op">{</span></span></span>
<span class="r-in"><span>    <span class="va">df.filtered</span> <span class="op">=</span> <span class="va">hurricane</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span></span>
<span class="r-in"><span>        <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="fu">branch</span><span class="op">(</span><span class="va">death_outliers</span>,</span></span>
<span class="r-in"><span>                   <span class="st">"no_exclusion"</span> <span class="op">~</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>                   <span class="st">"most_extreme"</span> <span class="op">~</span> <span class="va">name</span> <span class="op">!=</span> <span class="st">"Katrina"</span>,</span></span>
<span class="r-in"><span>                   <span class="st">"two_most_extreme"</span> <span class="op">~</span> <span class="op">!</span><span class="op">(</span><span class="va">name</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Katrina"</span>, <span class="st">"Audrey"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Example 4: using branch as a function</span></span></span>
<span class="r-in"><span><span class="co"># An alternate way of implementing the `branch()` function from Example 2 may be:</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">M.4</span> <span class="op">=</span> <span class="fu"><a href="multiverse.html">multiverse</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="inside.html">inside</a></span><span class="op">(</span><span class="va">M.4</span>, <span class="op">{</span></span></span>
<span class="r-in"><span>    <span class="va">duration_transform</span> <span class="op">=</span> <span class="fu">branch</span><span class="op">(</span><span class="va">data_trans</span>,</span></span>
<span class="r-in"><span>        <span class="st">"log-transformed"</span> <span class="op">~</span> <span class="va">log</span>,</span></span>
<span class="r-in"><span>        <span class="st">"un-transformed"</span> <span class="op">~</span> <span class="va">identity</span></span></span>
<span class="r-in"><span>    <span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>    <span class="va">duration</span> <span class="op">=</span> <span class="fu">duration_transform</span><span class="op">(</span><span class="va">data.userlogs.raw</span><span class="op">$</span><span class="va">duration</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Example 5: continuous option values for a parameter</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">M.5</span> <span class="op">=</span> <span class="fu"><a href="multiverse.html">multiverse</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="inside.html">inside</a></span><span class="op">(</span><span class="va">M.5</span>, <span class="op">{</span></span></span>
<span class="r-in"><span>  <span class="fu">branch</span><span class="op">(</span><span class="va">foo</span>, <span class="st">"option1"</span> <span class="op">~</span> <span class="fl">1</span>, .options <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">M.6</span> <span class="op">=</span> <span class="fu"><a href="multiverse.html">multiverse</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># alternatively, we could specify how we want the vector to be expanded</span></span></span>
<span class="r-in"><span><span class="co"># for continuous parameters</span></span></span>
<span class="r-in"><span><span class="fu"><a href="inside.html">inside</a></span><span class="op">(</span><span class="va">M.6</span>, <span class="op">{</span></span></span>
<span class="r-in"><span>  <span class="fu">branch</span><span class="op">(</span><span class="va">foo</span>, <span class="st">"option1"</span> <span class="op">~</span> <span class="fl">1</span>, .options <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span>, by <span class="op">=</span> <span class="fl">0.1</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span><span class="op">)</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Universes {1 and 12} appear to be duplicates. This may be because the tree you created is asymmetric (did you use nested branch calls?). Please verify and prune universes before proceeding with your analysis. See vignette('branch') for more details.</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># }</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by <a href="http://abhsarma.github.io" class="external-link">Abhraneel Sarma</a>, <a href="http://www.mjskay.com" class="external-link">Matthew Kay</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

